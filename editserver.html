<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Edit Server (Hidden)</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body{ font-family:'Press Start 2P', cursive; background:#111 url('https://i.imgur.com/fZ0oZqP.png') repeat; background-size:64px; color:#fff; margin:0; text-align:center; }
main{ margin-top:40px; }
select,input,textarea,button{ display:block; margin:10px auto; padding:10px; width:60%; border:none; border-radius:5px; font-family:inherit; font-size:10px; }
button{ background:#2e7d32; color:#fff; cursor:pointer; }
button:hover{ background:#388e3c; }
img.preview{ max-width:150px; margin-top:10px; border-radius:8px; display:none; }
.server-select{ width:60%; margin-bottom:20px; }
</style>
</head>
<body>

<h2>Edit Server</h2>
<div id="mainForm" style="display:none;">
<select id="serverSelect" class="server-select"><option value="">Select a server</option></select>
<form id="editForm">
<input type="text" id="name" placeholder="Server Name" required>
<input type="file" id="imgFile" accept="image/*">
<img id="preview" class="preview">
<input type="text" id="addr" placeholder="Server Address" required>
<input type="text" id="port" placeholder="Port (Optional)">
<select id="verType" required>
<option value="">Select Version Type</option>
<option value="Java">Java</option>
<option value="Bedrock">Bedrock</option>
</select>
<input type="text" id="version" placeholder="Server Version (e.g. 1.20.1)" required>
<textarea id="desc" placeholder="Server Description" required></textarea>
<button type="submit">Save Changes</button>
<button type="button" id="cancelBtn">Cancel</button>
</form>
</div>

<script>
const password="0021";
if(prompt("Enter password:")!==password){ alert("Access Denied!"); document.body.innerHTML="<h2 style='color:red;margin-top:50px;'>Access Denied</h2>"; }
else{ document.getElementById('mainForm').style.display='block'; }

const servers=JSON.parse(localStorage.getItem('servers')||'[]');
const serverSelect=document.getElementById('serverSelect');
const editForm=document.getElementById('editForm');
const nameInput=document.getElementById('name');
const addrInput=document.getElementById('addr');
const portInput=document.getElementById('port');
const verTypeSelect=document.getElementById('verType');
const versionInput=document.getElementById('version');
const descInput=document.getElementById('desc');
const imgFile=document.getElementById('imgFile');
const preview=document.getElementById('preview');
let imgData='';
let editingIndex=null;

// Populate dropdown
servers.forEach((s,i)=>{
  const opt=document.createElement('option');
  opt.value=i;
  opt.textContent=s.name;
  serverSelect.appendChild(opt);
});

// Select server to edit
serverSelect.addEventListener('change',()=>{
  const i=serverSelect.value;
  if(i===''){ editForm.style.display='none'; return; }
  editingIndex=i;
  const s=servers[i];
  nameInput.value=s.name;
  addrInput.value=s.addr;
  portInput.value=s.port;
  verTypeSelect.value=s.verType;
  versionInput.value=s.version;
  descInput.value=s.desc;
  imgData=s.img;
  preview.src=imgData; preview.style.display='block';
  editForm.style.display='block';
});

imgFile.addEventListener('change',e=>{
  const file=e.target.files[0]; if(!file) return;
  const reader=new FileReader();
  reader.onload=function(ev){ imgData=ev.target.result; preview.src=imgData; preview.style.display='block'; }
  reader.readAsDataURL(file);
});

// Save changes
editForm.addEventListener('submit',e=>{
  e.preventDefault();
  if(editingIndex===null) return;
  servers[editingIndex]={
    name:nameInput.value,
    img:imgData,
    addr:addrInput.value,
    port:portInput.value,
    verType:verTypeSelect.value,
    version:versionInput.value,
    desc:descInput.value
  };
  localStorage.setItem('servers',JSON.stringify(servers));
  alert('Server updated!');
  location.reload();
});

document.getElementById('cancelBtn').addEventListener('click',()=>{
  editForm.style.display='none';
  preview.style.display='none';
});
</script>
</body>
</html>
