<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OMAN SERVERS by Alhadhrami</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body { font-family: 'Press Start 2P', cursive; margin:0; background:black; color:#00ff00; text-align:center; overflow-x:hidden;}
canvas#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
header{background:#111;padding:20px 0;border-bottom:2px solid #00ff00;}
header h1{font-size:22px;margin:0;}
main{padding:20px;max-width:900px;margin:auto;}
input,button{font-family:'Press Start 2P',cursive;margin:5px 0;padding:8px;border-radius:5px;border:1px solid #00ff00;background:black;color:#00ff00;display:block;width:60%;margin-left:auto;margin-right:auto;}
button{cursor:pointer;background:#00ff00;color:black;font-weight:bold;}
button:hover{opacity:0.8;}
.server-list{display:flex;flex-wrap:wrap;justify-content:center;gap:15px;margin-top:20px;}
.server{background:rgba(0,0,0,0.85);border:2px solid #00ff00;padding:10px;border-radius:8px;width:250px;text-align:center;}
.server img{width:100px;height:100px;object-fit:cover;margin-bottom:5px;}
.feature{background:rgba(0,0,0,0.85);border:2px solid #00ff00;padding:10px;margin:10px;border-radius:8px;text-align:left;}
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>
<header><h1>OMAN SERVERS by Alhadhrami</h1></header>
<main>
<input type="text" id="searchInput" placeholder="Search servers by name...">
<div class="server-list" id="server-list"></div>

<h3>Suggestions</h3>
<input type="text" id="featureName" placeholder="Your Name">
<textarea id="featureText" placeholder="What do you want updated?"></textarea>
<button onclick="addFeature()">Submit Suggestion</button>
<div id="featureList"></div>
</main>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyD_LtDCU_fI1LazKYuuFBHf4tC_pzHAiCw",
  authDomain: "omanwebsite-ae60c.firebaseapp.com",
  projectId: "omanwebsite-ae60c",
  storageBucket: "omanwebsite-ae60c.firebasestorage.app",
  messagingSenderId: "554330436845",
  appId: "1:554330436845:web:5e9e90857410848ee488e4",
  measurementId: "G-6HBLKC0N5L"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let servers = [];
const serverList = document.getElementById('server-list');
const searchInput = document.getElementById('searchInput');

function renderServers(filter=""){
  serverList.innerHTML="";
  servers.filter(s=>s.name.toLowerCase().includes(filter.toLowerCase())).forEach(s=>{
    const div=document.createElement('div');
    div.className='server';
    const statusColor = s.status==='Online' ? 'blue':'red';
    div.innerHTML=`<h4>${s.name}</h4>
      <div style="color:${statusColor};font-weight:bold;">Status: ${s.status}</div>
      <div>Version: ${s.version}</div>
      <div>Address: ${s.addr}${s.port?':'+s.port:''}</div>
      <img src="${s.img}">
      <p>${s.desc}</p>`;
    serverList.appendChild(div);
  });
}

// Fetch servers from Firebase
db.collection("servers").orderBy("name").onSnapshot(snapshot=>{
  servers = snapshot.docs.map(doc=>doc.data());
  renderServers(searchInput.value);
});

searchInput.addEventListener('input',()=>renderServers(searchInput.value));

// Suggestions
const featureList = document.getElementById('featureList');
function renderFeatures(features){
  featureList.innerHTML='';
  features.forEach(f=>{
    const div=document.createElement('div');
    div.className='feature';
    const date=f.date?new Date(f.date).toLocaleString():'';
    div.innerHTML=`<strong>${f.name}</strong>: ${f.text} <small>${date}</small>`;
    featureList.appendChild(div);
  });
}
db.collection("suggestions").orderBy("date","desc").onSnapshot(snapshot=>{
  const features = snapshot.docs.map(doc=>doc.data());
  renderFeatures(features);
});
async function addFeature(){
  const name=document.getElementById('featureName').value.trim();
  const text=document.getElementById('featureText').value.trim();
  if(!name||!text){alert('Enter your name and suggestion'); return;}
  await db.collection("suggestions").add({name,text,date:new Date().toISOString()});
  document.getElementById('featureName').value='';
  document.getElementById('featureText').value='';
}

// Matrix background animation
const canvas = document.getElementById('bgCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;
const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()";
const fontSize = 14;
const columns = Math.floor(canvas.width / fontSize);
const drops = Array(columns).fill(1);
function drawMatrix(){
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#00ff00"; ctx.font = fontSize+"px monospace";
  for(let i=0;i<drops.length;i++){
    const text = letters.charAt(Math.floor(Math.random()*letters.length));
    ctx.fillText(text,i*fontSize,drops[i]*fontSize);
    drops[i]++; if(drops[i]*fontSize>canvas.height && Math.random()>0.975)drops[i]=0;
  }
}
setInterval(drawMatrix,50);
window.addEventListener('resize',()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});

// Shortcut to admin (Ctrl+A)
document.addEventListener('keydown',function(e){
  if(e.ctrlKey && e.key.toLowerCase()==='a'){window.location.href='admin.html';}
});
</script>
</body>
</html>
