<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel - MineServer Network</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Press Start 2P', cursive;
    margin: 0;
    background: black;
    color: #00ff00;
    text-align: center;
    overflow-x: hidden;
}
canvas#bgCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
}
header {
    background-color: #111;
    border-bottom: 2px solid #00ff00;
    padding: 20px 0;
}
header h1 { font-size: 22px; margin: 0; }
main { padding: 20px; max-width: 900px; margin: auto; }
input, select, textarea, button {
    font-family: 'Press Start 2P', cursive;
    margin: 5px 0;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #00ff00;
    background: black;
    color: #00ff00;
    display: block;
    width: 60%;
    margin-left: auto;
    margin-right: auto;
}
button { cursor: pointer; background: #00ff00; color: black; font-weight: bold; }
button:hover { opacity: 0.8; }
.server-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 20px; }
.server {
    background: rgba(0,0,0,0.85);
    border: 2px solid #00ff00;
    padding: 10px;
    border-radius: 8px;
    width: 450px;
    text-align: center;
}
.server img { width: 100px; height: 100px; object-fit: cover; margin-bottom: 5px; }
.stats, .activity-log, .admin-message, .quick-links, .suggestions { 
    border: 2px solid #00ff00; 
    border-radius: 8px; 
    padding: 10px; 
    margin: 20px auto; 
    max-width: 600px;
}
textarea { height: 60px; }
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<header><h1>Admin Panel</h1></header>

<main>
<input type="text" id="searchInput" placeholder="Search servers by name...">

<div class="add-server">
<h3>Add New Server</h3>

<label>Server Name</label>
<input type="text" id="newName" placeholder="Enter server name">

<label>Address</label>
<input type="text" id="newAddr" placeholder="Enter server address">

<label>Port</label>
<input type="text" id="newPort" placeholder="Optional port">

<label>Type</label>
<select id="newVerType">
<option value="">Select type</option>
<option value="Java">Java</option>
<option value="Bedrock">Bedrock</option>
</select>

<label>Status</label>
<select id="newStatus">
<option value="Online">Online</option>
<option value="Offline">Offline</option>
</select>

<label>Version</label>
<input type="text" id="newVersion" placeholder="Server version">

<label>Description</label>
<textarea id="newDesc" placeholder="Enter server description"></textarea>

<label>Server Picture</label>
<input type="file" id="newImgFile" accept="image/*">

<button onclick="addServer()">Add Server</button>
</div>

<div class="server-list" id="server-list"></div>

<div class="stats" id="stats"></div>

<div class="quick-links">
<h3>Quick Links</h3>
<button onclick="openPage('editserver.html')">Edit Server</button>
<button onclick="openPage('removeserver.html')">Remove Server</button>
<button onclick="openPage('setstatus.html')">Set Status</button>
</div>

<div class="admin-message">
<h3>Admin Notes</h3>
<textarea id="adminNotes" placeholder="Write notes..." style="height:80px;"></textarea>
<button onclick="saveNotes()">Save Notes</button>
</div>

<div class="activity-log" id="activityLog"><h3>Activity Log</h3></div>

<!-- Suggestions Section -->
<div class="suggestions">
<h3>User Suggestions / Comments</h3>
<div id="suggestionsList"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyD_LtDCU_fI1LazKYuuFBHf4tC_pzHAiCw",
  authDomain: "omanwebsite-ae60c.firebaseapp.com",
  projectId: "omanwebsite-ae60c",
  storageBucket: "omanwebsite-ae60c.appspot.com",
  messagingSenderId: "554330436845",
  appId: "1:554330436845:web:5e9e90857410848ee488e4",
  measurementId: "G-6HBLKC0N5L"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const password="0021";
if(prompt("Enter admin password:")!==password){document.body.innerHTML="<h2 style='color:red;margin-top:50px;'>Access Denied</h2>";}

let servers=[];
db.collection('servers').get().then(snapshot=>{
    servers=snapshot.docs.map(d=>({id:d.id,...d.data()}));
    renderServers();
});

const serverList=document.getElementById('server-list');
const searchInput=document.getElementById('searchInput');

function renderServers(filter=""){
    serverList.innerHTML="";
    servers.filter(s=>s.name.toLowerCase().includes(filter.toLowerCase())).forEach((s,i)=>{
        const div=document.createElement('div'); 
        div.className='server';
        const statusColor = s.status==='Online' ? 'blue' : 'red';
        div.innerHTML=`
            <h4>${s.name}</h4>
            <div style="color:${statusColor}; font-weight:bold;">Status: ${s.status}</div>
            <img src="${s.img}">
            <input value="${s.addr}">
            <input value="${s.port}">
            <select>
                <option ${s.verType==='Java'?'selected':''}>Java</option>
                <option ${s.verType==='Bedrock'?'selected':''}>Bedrock</option>
            </select>
            <input value="${s.version}">
            <textarea>${s.desc}</textarea>
            <button onclick="copyAddr(${i})">Copy Address</button>
            <button onclick="toggleStatus(${i})">Toggle Status</button>
        `;
        serverList.appendChild(div);
    });
}

function addServer(){
    const name=document.getElementById('newName').value;
    const addr=document.getElementById('newAddr').value;
    const port=document.getElementById('newPort').value;
    const verType=document.getElementById('newVerType').value;
    const status=document.getElementById('newStatus').value;
    const version=document.getElementById('newVersion').value;
    const desc=document.getElementById('newDesc').value;
    const fileInput=document.getElementById('newImgFile');
    if(!name||!addr||!verType||!status||!version||!desc||fileInput.files.length===0){alert('Please fill all fields and choose an image');return;}
    const reader=new FileReader();
    reader.onload=function(e){
        db.collection('servers').add({name, addr, port, verType, status, version, desc, img:e.target.result}).then(docRef=>{
            servers.push({id:docRef.id,name,addr,port,verType,status,version,desc,img:e.target.result});
            renderServers(searchInput.value);
            alert('Server added!');
            document.getElementById('newName').value='';
            document.getElementById('newAddr').value='';
            document.getElementById('newPort').value='';
            document.getElementById('newVerType').value='';
            document.getElementById('newStatus').value='Online';
            document.getElementById('newVersion').value='';
            document.getElementById('newDesc').value='';
            document.getElementById('newImgFile').value='';
        });
    };
    reader.readAsDataURL(fileInput.files[0]);
}

function copyAddr(i){navigator.clipboard.writeText(servers[i].addr+(servers[i].port?':'+servers[i].port:''));alert('Address copied');}
function toggleStatus(i){servers[i].status=servers[i].status==='Online'?'Offline':'Online';db.collection('servers').doc(servers[i].id).update({status:servers[i].status});renderServers(searchInput.value);}
function openPage(url){window.location.href=url;}
function saveNotes(){localStorage.setItem('adminNotes',document.getElementById('adminNotes').value);alert('Notes saved!');}
document.getElementById('adminNotes').value=localStorage.getItem('adminNotes')||'';

searchInput.addEventListener('input',()=>renderServers(searchInput.value));

// Matrix background animation
const canvas = document.getElementById('bgCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()";
const fontSize = 14;
const columns = Math.floor(canvas.width / fontSize);
const drops = Array(columns).fill(1);

function drawMatrix(){
    ctx.fillStyle = "rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "#00ff00";
    ctx.font = fontSize + "px monospace";
    for(let i=0;i<drops.length;i++){
        const text = letters.charAt(Math.floor(Math.random()*letters.length));
        ctx.fillText(text, i*fontSize, drops[i]*fontSize);
        drops[i]++;
        if(drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
    }
}
setInterval(drawMatrix, 50);
window.addEventListener('resize', () => {canvas.width = window.innerWidth; canvas.height = window.innerHeight;});

// Suggestions management
function fetchSuggestions(){
    db.collection('suggestions').get().then(snapshot=>{
        const container = document.getElementById('suggestionsList');
        container.innerHTML = '';
        snapshot.forEach(doc=>{
            const s = doc.data();
            const div = document.createElement('div');
            div.style.border = "1px solid #00ff00";
            div.style.padding = "5px";
            div.style.margin = "5px 0";
            div.style.background = "rgba(0,0,0,0.7)";
            div.style.textAlign = "center";
            div.innerHTML = `
                <b>${s.username || 'Anonymous'}:</b> ${s.comment}
                <br>
                <button onclick="removeSuggestion('${doc.id}')">Remove</button>
            `;
            container.appendChild(div);
        });
    });
}

function removeSuggestion(id){
    if(confirm('Remove this suggestion?')){
        db.collection('suggestions').doc(id).delete().then(()=>fetchSuggestions());
    }
}

// Initial fetch
fetchSuggestions();
</script>

</body>
</html>
