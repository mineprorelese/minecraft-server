<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel - MineServer Network</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Press Start 2P', cursive;
  background: radial-gradient(circle at center, #000 0%, #020 100%);
  color: #00ff00;
  text-align: center;
  margin: 0;
  overflow-x: hidden;
}
h1 {
  margin-top: 20px;
  text-shadow: 0 0 10px #00ff00;
}
form, .server {
  background: rgba(0,0,0,0.85);
  border: 1px solid #00ff00;
  border-radius: 10px;
  padding: 15px;
  margin: 20px auto;
  width: 80%;
  max-width: 600px;
  box-shadow: 0 0 10px #00ff00;
}
input, textarea, select {
  width: 90%;
  padding: 10px;
  margin: 6px 0;
  border: 1px solid #00ff00;
  background: black;
  color: #00ff00;
  border-radius: 5px;
  font-family: 'Press Start 2P', cursive;
  font-size: 10px;
}
button {
  background: #00ff00;
  color: black;
  border: none;
  padding: 10px 20px;
  margin: 8px;
  font-weight: bold;
  border-radius: 5px;
  cursor: pointer;
}
button:hover {
  box-shadow: 0 0 10px #00ff00;
}
.status {
  font-size: 12px;
  margin-top: 10px;
}
.status.online { color: #00bfff; } /* blue */
.status.offline { color: #ff3333; } /* red */
.server img {
  max-width: 120px;
  border-radius: 8px;
  margin-bottom: 10px;
}
.bg-animation {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle, rgba(0,255,0,0.2) 0%, transparent 70%);
  animation: pulse 5s infinite alternate;
  z-index: -1;
}
@keyframes pulse {
  0% { transform: scale(1); opacity: 0.3; }
  100% { transform: scale(1.2); opacity: 0.7; }
}
</style>
</head>
<body>
<div class="bg-animation"></div>
<h1>Admin Control Panel</h1>

<form id="addForm">
  <input type="password" id="adminPass" placeholder="Enter Password" required>
  <input type="text" id="name" placeholder="Server Name" required>
  <input type="file" id="img" accept="image/*">
  <input type="text" id="addr" placeholder="Server Address" required>
  <input type="text" id="port" placeholder="Port (Optional)">
  <select id="verType">
    <option value="">Select Type</option>
    <option value="Java">Java</option>
    <option value="Bedrock">Bedrock</option>
  </select>
  <select id="status">
    <option value="Online">Online</option>
    <option value="Offline">Offline</option>
  </select>
  <input type="text" id="version" placeholder="Server Version">
  <textarea id="desc" placeholder="Description"></textarea>
  <button type="submit">Add Server</button>
</form>

<h2>Manage Servers</h2>
<div id="serverList">Loading servers...</div>

<script>
const API_URL = "https://api.npoint.io/92f9eb9cee57ecd2ba23";
const PASSWORD = "0021";
let servers = [];

async function fetchServers() {
  const res = await fetch(API_URL);
  servers = await res.json();
  renderServers();
}

function renderServers() {
  const list = document.getElementById('serverList');
  list.innerHTML = '';
  servers.forEach((s, i) => {
    const div = document.createElement('div');
    div.className = 'server';
    div.innerHTML = `
      <img src="${s.img || ''}" alt="${s.name}">
      <h3>${s.name}</h3>
      <p><b>IP:</b> ${s.addr}${s.port ? ':' + s.port : ''}</p>
      <p><b>Type:</b> ${s.verType}</p>
      <p><b>Version:</b> ${s.version}</p>
      <p><b>Description:</b> ${s.desc}</p>
      <p class="status ${s.status.toLowerCase()}">${s.status}</p>
      <button onclick="toggleStatus(${i})">Toggle Status</button>
      <button onclick="editServer(${i})">Edit</button>
      <button onclick="removeServer(${i})">Remove</button>
    `;
    list.appendChild(div);
  });
}

document.getElementById('addForm').addEventListener('submit', async e => {
  e.preventDefault();
  const pass = document.getElementById('adminPass').value;
  if (pass !== PASSWORD) return alert('Wrong password!');
  
  const file = document.getElementById('img').files[0];
  let imgData = '';
  if (file) {
    const reader = new FileReader();
    reader.onload = async () => {
      imgData = reader.result;
      const newServer = {
        name: document.getElementById('name').value,
        img: imgData,
        addr: document.getElementById('addr').value,
        port: document.getElementById('port').value,
        verType: document.getElementById('verType').value,
        status: document.getElementById('status').value,
        version: document.getElementById('version').value,
        desc: document.getElementById('desc').value
      };
      servers.push(newServer);
      await updateServers();
      alert("Server added!");
      e.target.reset();
      fetchServers();
    };
    reader.readAsDataURL(file);
  } else {
    alert("Please choose an image!");
  }
});

async function toggleStatus(i) {
  servers[i].status = (servers[i].status === "Online") ? "Offline" : "Online";
  await updateServers();
  fetchServers();
}

async function editServer(i) {
  const newName = prompt("Edit name:", servers[i].name);
  if (newName !== null) servers[i].name = newName;
  const newDesc = prompt("Edit description:", servers[i].desc);
  if (newDesc !== null) servers[i].desc = newDesc;
  await updateServers();
  fetchServers();
}

async function removeServer(i) {
  if (!confirm("Remove this server?")) return;
  servers.splice(i, 1);
  await updateServers();
  fetchServers();
}

async function updateServers() {
  await fetch(API_URL, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(servers)
  });
}

fetchServers();
</script>
</body>
</html>
