<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Control Panel</title>
<style>
body {
  background: black;
  color: #00ff00;
  font-family: 'Courier New', monospace;
  text-align: center;
  overflow-x: hidden;
  margin: 0;
  padding: 0;
}
h1 {
  color: #00ff00;
  text-shadow: 0 0 10px #00ff00;
  margin-top: 20px;
}
button {
  background: transparent;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 8px 15px;
  margin: 5px;
  cursor: pointer;
  transition: 0.3s;
}
button:hover {
  background: #00ff00;
  color: black;
  box-shadow: 0 0 10px #00ff00;
}
input, select, textarea {
  background: black;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 8px;
  width: 80%;
  margin: 5px 0;
  text-align: center;
}
textarea {
  resize: none;
}
.server {
  border: 1px solid #00ff00;
  padding: 10px;
  border-radius: 10px;
  margin: 10px auto;
  width: 80%;
  box-shadow: 0 0 10px #00ff00;
  background: rgba(0, 0, 0, 0.8);
}
.server img {
  width: 100px;
  height: 100px;
  border-radius: 10px;
  border: 1px solid #00ff00;
}
#matrix {
  position: fixed;
  top: 0; left: 0;
  z-index: -1;
  width: 100%;
  height: 100%;
  background: black;
  overflow: hidden;
}
canvas {
  display: block;
}
</style>
</head>
<body>

<canvas id="matrix"></canvas>

<h1>Admin Control Panel</h1>

<div class="add-server">
  <h3>Add New Server</h3>
  <input type="text" id="newName" placeholder="Enter server name"><br>
  <input type="text" id="newAddr" placeholder="Enter server address"><br>
  <input type="text" id="newPort" placeholder="Optional port"><br>
  <select id="newVerType">
    <option value="">Select Type</option>
    <option value="Java">Java</option>
    <option value="Bedrock">Bedrock</option>
  </select><br>
  <select id="newStatus">
    <option value="Online">Online</option>
    <option value="Offline">Offline</option>
  </select><br>
  <input type="text" id="newVersion" placeholder="Server version"><br>
  <textarea id="newDesc" placeholder="Server description"></textarea><br>
  <label>Server Image:</label><br>
  <input type="file" id="newImg" accept="image/*"><br>
  <button onclick="addServer()">Add Server</button>
</div>

<hr style="width: 60%; border-color: #00ff00; margin: 30px auto;">

<div id="serverList"></div>

<script>
const API_URL = "https://api.npoint.io/92f9eb9cee57ecd2ba23";
let servers = [];

async function loadServers() {
  const res = await fetch(API_URL);
  servers = await res.json();
  renderServers();
}

async function saveServers() {
  await fetch(API_URL, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(servers)
  });
}

function renderServers() {
  const list = document.getElementById("serverList");
  list.innerHTML = '';
  servers.forEach((s, i) => {
    const statusColor = s.status === 'Online' ? '#00bfff' : '#ff3333';
    const div = document.createElement('div');
    div.className = 'server';
    div.innerHTML = `
      <h4>${s.name}</h4>
      <div style="color:${statusColor}; font-weight:bold;">${s.status}</div>
      <img src="${s.img || ''}" alt="Server Image">
      <p><b>Address:</b> ${s.addr}${s.port ? ':' + s.port : ''}</p>
      <p><b>Version:</b> ${s.version || ''}</p>
      <p><b>Type:</b> ${s.verType}</p>
      <p><b>Description:</b> ${s.desc}</p>
      <button onclick="toggleStatus(${i})">Toggle Status</button>
      <button onclick="editServer(${i})">Edit</button>
      <button onclick="removeServer(${i})">Remove</button>
    `;
    list.appendChild(div);
  });
}

function addServer() {
  const name = document.getElementById('newName').value;
  const addr = document.getElementById('newAddr').value;
  const port = document.getElementById('newPort').value;
  const verType = document.getElementById('newVerType').value;
  const status = document.getElementById('newStatus').value;
  const version = document.getElementById('newVersion').value;
  const desc = document.getElementById('newDesc').value;
  const imgInput = document.getElementById('newImg');

  if (!name || !addr || !verType) {
    alert("Please fill required fields.");
    return;
  }

  if (imgInput.files && imgInput.files[0]) {
    const reader = new FileReader();
    reader.onload = async function(e) {
      const img = e.target.result;
      servers.push({ name, addr, port, verType, status, version, desc, img });
      await saveServers();
      renderServers();
      alert("Server added!");
    };
    reader.readAsDataURL(imgInput.files[0]);
  } else {
    servers.push({ name, addr, port, verType, status, version, desc, img: '' });
    saveServers();
    renderServers();
  }
}

function toggleStatus(i) {
  servers[i].status = servers[i].status === 'Online' ? 'Offline' : 'Online';
  saveServers();
  renderServers();
}

function removeServer(i) {
  if (confirm(`Remove ${servers[i].name}?`)) {
    servers.splice(i, 1);
    saveServers();
    renderServers();
  }
}

function editServer(i) {
  const s = servers[i];
  const name = prompt("Edit name:", s.name);
  if (name === null) return;
  s.name = name;
  const desc = prompt("Edit description:", s.desc);
  if (desc !== null) s.desc = desc;
  saveServers();
  renderServers();
}

loadServers();

// Matrix background animation
const canvas = document.getElementById('matrix');
const ctx = canvas.getContext('2d');
canvas.height = window.innerHeight;
canvas.width = window.innerWidth;
const letters = Array(256).join("1").split("");
function drawMatrix() {
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#00ff00";
  letters.map((y, index) => {
    const text = String.fromCharCode(3e4 + Math.random() * 33);
    const x = index * 10;
    ctx.fillText(text, x, y);
    letters[index] = y > 758 + Math.random() * 1e4 ? 0 : y + 10;
  });
}
setInterval(drawMatrix, 33);
</script>

</body>
</html>
